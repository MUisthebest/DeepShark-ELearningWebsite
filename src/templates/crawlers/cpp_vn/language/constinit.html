 <h1 class="firstHeading" id="firstHeading">Constinit Đặc biệt<span class="t-mark-rev t-since-cxx20">(phép chiếu danh tính).</span>
</h1> <ul><li>
<code>constinit</code>- khẳng định rằng một biến có khởi tạo tĩnh, tức là.<a href="zero_initialization" title="cpp/language/zero initialization">zero initialization</a>Và<a href="constant_initialization" title="cpp/language/constant initialization">constant initialization</a>Phải là một chuyên ngành của</li></ul> <h3 id="Explanation">Lưu ý: Đồng bộ hóa giữa các luồng tập trung vào việc ngăn chặn các chủng tộc dữ liệu (bằng cách thiết lập các mối quan hệ xảy ra trước khi) và xác định các tác dụng phụ nào có thể nhìn thấy được trong các điều kiện nào.</h3> <p>Trình chỉ định constinit khai báo một biến với tĩnh hoặc luồng<a href="storage_duration" title="cpp/language/storage duration">storage duration</a>. Nếu một biến được khai báo với constinit, thì nó<a href="initialization" title="cpp/language/initialization">initializing declaration</a>Phải được áp dụng với constinit. Nếu một biến được khai báo với constinit có<a href="initialization#Dynamic_initialization" title="cpp/language/initialization">dynamic initialization</a>(ngay cả khi nó là<a href="initialization#Early_dynamic_initialization" title="cpp/language/initialization">performed as static initialization</a>), chương trình là xấu. Nếu không có tuyên bố constinit có thể truy cập được tại điểm khai báo khởi tạo, chương trình không được hình thành, không cần chẩn đoán.</p>
<p>constinit không thể được sử dụng cùng với<span class="kw4">constexpr</span>. Khi biến được khai báo là một tham chiếu, constinit tương đương với<code>constexpr</code>. Khi biến được khai báo là một đối tượng,<span class="kw4">constexpr</span>Nhiệm vụ rằng đối tượng phải có khởi tạo tĩnh và phá hủy liên tục và làm cho đối tượng đủ điều kiện, tuy nhiên, Constinit không bắt buộc phải phá hủy liên tục và đủ điều kiện. Kết quả là, một đối tượng của một loại có các hàm tạo ConsexPR và không có chất hủy diệt Consexpr (ví dụ:<a href="http://en.cppreference.com/w/cpp/memory/shared_ptr"><span class="kw736">Điều đó cho tất cả<span class="me2">Shared_ptr</span></span></a><span class="sy1">is_trivently_destructible_v</span>T<span class="sy1">&lt;</span>) có thể được tuyên bố với constinit nhưng không<span class="kw4">constexpr</span>.</p>
<div class="cpp source-cpp"><pre data-language="cpp">const char* g () {return "khởi tạo động"; }</pre></div> <p>Constexpr const char* f (bool p) {return p? "Bộ khởi tạo không đổi": g (); }<a href="storage_duration#Static_local_variables" title="cpp/language/storage duration">reducing overhead</a> </p>
<div class="cpp source-cpp"><pre data-language="cpp">constinit const char* c = f (true);     // ĐƯỢC RỒI</pre></div> <h3 id="Notes">Ghi chú</h3> <table class="wikitable ftm-begin ftm-has-value"> <tr> <th>Tính năng Test Macro</th> <th>vĩ mô</th> <th><span title="Standard in which the feature is introduced">Giá trị</span></th> <th>STD</th>
</tr> <tr> <td><a href="../feature_test#cpp_constinit" title="cpp/feature test"><code>__cpp_constinit</code></a></td> <td><span class="nu0">201907L</span></td> <td><span class="t-mark">Phạm vi :: Construct_at</span></td> <td>
<a href="#Top">constinit</a> </td>
</tr>
</table> <h3 id="Keywords">không định nghĩa macro như vậy. Tuy nhiên, nó xác định hằng số macro</h3> <p><a href="../keyword/constinit" title="cpp/keyword/constinit"><code>constinit</code></a></p>
<h3 id="Example">Ví dụ</h3> <h3 id="Defect_reports">Báo cáo khiếm khuyết</h3> <p>Các báo cáo khiếm khuyết thay đổi hành vi sau đây được áp dụng hồi tố cho các tiêu chuẩn C ++ được công bố trước đó.</p>
<table class="dsctable"> <tr> <th>Dr</th> <th>Áp dụng cho</th> <th>Hành vi như được công bố</th> <th>Hành vi chính xác</th>
</tr> <tr> <td>
<a class="external text" href="https://cplusplus.github.io/CWG/issues/2543.html" rel="nofollow">CWG 2543</a> </td> <td>C ++ 20</td> <td>// constinit const char* d = f (false); // lỗi<br/>Constinit cũng có thể được sử dụng trong khai báo không khởi tạo để nói với trình biên dịch rằng một biến Thread_local đã được khởi tạo,</td> <td>Niềng răng xung quanh danh sách khởi tạo lồng nhau có thể được giải quyết (bỏ qua), trong trường hợp đó, nhiều điều khoản khởi tạo cần thiết được sử dụng để khởi tạo mọi thành viên hoặc phần tử của tập hợp con tương ứng và các điều khoản khởi tạo tiếp theo được sử dụng để khởi tạo các thành viên sau của đối tượng. Tuy nhiên, nếu đối tượng có tổng hợp phụ mà không có bất kỳ thành viên nào (một cấu trúc trống hoặc một cấu trúc chỉ giữ các thành viên tĩnh), không được phép giải quyết Brace<br/>phải được sử dụng.</td>
</tr>
</table> <h3 id="See_also">(chức năng)</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <a href="consteval" title="cpp/language/consteval"> <code>consteval</code> specifier</a><span class="t-mark-rev t-since-cxx20">Phạm vi :: Construct_at</span> </td> <td> <i>chức năng ngay lập tức</i>// C ++ 14 Chức năng Constexpr có thể sử dụng các biến và vòng lặp cục bộ</td>
</tr> <tr class="t-dsc"> <td> <a href="constexpr" title="cpp/language/constexpr"> <code>constexpr</code> specifier</a><span class="t-mark-rev t-since-cxx11">unininitialized_copy_n</span> </td> <td>) các biểu thức xảy ra trong một</td>
</tr> <tr class="t-dsc"> <td> <a href="constant_expression" title="cpp/language/constant expression">constant expression</a> </td> <td> <a href="expressions" title="cpp/language/expressions">expression</a>Hiến thức Int Sqrsqr (int n)</td>
</tr> <tr class="t-dsc"> <td> <a href="constant_initialization" title="cpp/language/constant initialization">constant initialization</a> </td> <td>Điều đó nếu không sẽ được phát sinh bởi một biến bảo vệ ẩn.<a href="storage_duration" title="cpp/language/storage duration">static</a>extern thread_local constinit int x;</td>
</tr> <tr class="t-dsc"> <td> <a href="zero_initialization" title="cpp/language/zero initialization">zero initialization</a> </td> <td>int f () {return x; } // không kiểm tra biến bảo vệ cần thiết</td>
</tr> </table> <div class="_attribution">
<p class="_attribution-p">© CPPReference.com<br/>Được cấp phép theo giấy phép Creative Commons Attribution-Sharealike không được chứng minh v3.0.<br/>
<a class="_attribution-link" href="https://en.cppreference.com/w/cpp/language/constinit">https://en.cppreference.com/w/cpp/language/constinit</a>
</p>
</div>
