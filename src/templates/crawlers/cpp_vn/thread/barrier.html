 <h1 class="firstHeading" id="firstHeading">std :: rào cản</h1> <table class="t-dcl-begin"> <tr class="t-dsc-header"> <th>C Thư viện<code><a href="../header/barrier" title="cpp/header/barrier">&lt;barrier&gt;</a></code> </th> <th> </th> <th> </th> </tr> <tr class="t-dcl t-since-cxx20"> <td> <pre data-language="cpp">Mẫu &lt;lớp hoàn thànhFunction = / * Xem bên dưới * /&gt;</pre>
</td> <td class="t-dcl-nopad"> </td> <td> <span class="t-mark-rev t-since-cxx20">(phép chiếu danh tính).</span> </td> </tr> </table> <p>lớp HH_MM_SS;<code>std::barrier</code>rào cản lớp học;<code><a href="latch" title="cpp/thread/latch">std::latch</a></code>Cung cấp một cơ chế phối hợp luồng, chặn một nhóm các luồng có kích thước đã biết cho đến khi tất cả các luồng trong nhóm đó đạt đến hàng rào. Không giống như<code><a href="latch" title="cpp/thread/latch">std::latch</a></code>, Rào cản có thể tái sử dụng: Một khi một nhóm các chủ đề đến không bị chặn, rào cản có thể được sử dụng lại. Không giống như</p>
<p>, Rào cản thực hiện một cuộc gọi có thể trống có thể trống trước khi bỏ chặn các chủ đề.<i>. Các chủ đề như vậy sau đó có thể chặn trên</i>Điểm đồng bộ pha<i>. Các chủ đề như vậy sau đó có thể chặn trên</i>. Sau khi xây dựng và kiểm tra đối tượng Sentry, có thể bỏ qua khoảng trắng hàng đầu, trích xuất một<a href="barrier/arrive" title="cpp/thread/barrier/arrive"><code>arrive</code></a>Điểm đồng bộ pha<i>. Các chủ đề như vậy sau đó có thể chặn trên</i>. Sau khi xây dựng và kiểm tra đối tượng Sentry, có thể bỏ qua khoảng trắng hàng đầu, trích xuất một<a href="barrier/wait" title="cpp/thread/barrier/wait"><code>wait</code></a>.</p>
<p>Điểm đồng bộ pha<i>Một rào cản</i>giai đoạn</p>
<ol>
<li>Các<i>Bao gồm các bước sau:</i>số lượng dự kiến<a href="barrier/arrive" title="cpp/thread/barrier/arrive"><code>arrive</code></a>hoặc<a href="barrier/arrive_and_drop" title="cpp/thread/barrier/arrive and drop"><code>arrive_and_drop</code></a>.</li>
<li>bị giảm bởi mỗi cuộc gọi đến<i>Khi số lượng dự kiến ​​đạt đến 0,</i>Bước hoàn thành pha<code>CompletionFunction</code>được chạy, có nghĩa là<a href="../atomic/memory_order#Strongly_happens-before" title="cpp/atomic/memory order">strongly happens-before</a>được gọi, và tất cả các luồng bị chặn trên điểm đồng bộ pha đều được bỏ chặn. Kết thúc của bước hoàn thành<br/>Tất cả các cuộc gọi đã được bỏ chặn bởi sự trở lại của bước hoàn thành.<a href="barrier/arrive" title="cpp/thread/barrier/arrive"><code>arrive</code></a>Thì<a href="barrier/arrive_and_drop" title="cpp/thread/barrier/arrive and drop"><code>arrive_and_drop</code></a>, hoặc<a href="barrier/wait" title="cpp/thread/barrier/wait"><code>wait</code></a>Chính xác một lần sau khi số lượng dự kiến ​​đạt đến 0, một luồng thực hiện bước hoàn thành trong quá trình gọi đến<a href="barrier/wait" title="cpp/thread/barrier/wait"><code>wait</code></a>.</li>
<li>, ngoại trừ việc nó được xác định là xác định liệu bước có thực thi hay không nếu không có cuộc gọi chủ đề nào<a href="barrier/arrive_and_drop" title="cpp/thread/barrier/arrive and drop"><code>arrive_and_drop</code></a>Khi bước hoàn thành hoàn thành, số lượng dự kiến ​​được đặt lại về giá trị được chỉ định khi xây dựng ít hơn số lượng cuộc gọi đến<i>Kể từ và tiếp theo</i>Giai đoạn rào cản</li>
</ol> <p>bắt đầu.<code>barrier</code>Những lời mời đồng thời của các chức năng thành viên của</p>
<h3 id="Template_parameters">là không xác định.</h3> <table class="t-par-begin"> <tr class="t-par"> <td>, Ngoại trừ bộ hủy diệt, không giới thiệu các cuộc đua dữ liệu.</td> <td>-</td> <td>Hoàn thành chức năng</td>
</tr> <tr class="t-par-req"> <td colspan="3">-<code>CompletionFunction</code>Loại loại 1 phải sao cho một đối tượng loại T có thể được chuyển đổi hoàn toàn thành Type1. Loại loại2 phải sao cho một đối tượng loại đầu vào có thể được bỏ qua và sau đó được chuyển đổi hoàn toàn thành type2. Loại<a href="../named_req/moveconstructible" title="cpp/named req/MoveConstructible">MoveConstructible</a>Và<a href="../named_req/destructible" title="cpp/named req/Destructible">Destructible</a>.<code><a href="http://en.cppreference.com/w/cpp/types/is_invocable"><span class="kw3229">Điều đó cho tất cả<span class="me2">loại đối tượng chức năng</span></span></a><span class="sy1">is_trivently_destructible_v</span>CompletionFunction<span class="sy3">Không có giá trị</span><span class="sy1">&lt;</span></code>// thực hiện đầu tiên<code>true</code>.</td>
</tr>
</table> <p>is_nothrow_invocable_v<code>CompletionFunction</code>Đối số mẫu mặc định của<a href="../named_req/defaultconstructible" title="cpp/named req/DefaultConstructible">DefaultConstructible</a>là một loại đối tượng chức năng không xác định, đáp ứng các yêu cầu của</p>
<p>. Gọi một lvalue của nó mà không có lập luận không có tác dụng.<code>completion_</code>nó đến một đối tượng<code>CompletionFunction</code>Mọi đối tượng rào cản đều hoạt động như thể nó giữ một thành viên dữ liệu không tĩnh chỉ dành cho giải trình<code>completion_()</code>và gọi nó bằng</p>
<h3 id="Member_types">nhà điều hành ()</h3> <table class="t-dsc-begin"> <tr class="t-dsc-hitem"> <th>Tên</th> <th>Sự định nghĩa</th>
</tr> <tr class="t-dsc"> <td> <code>arrival_token</code> </td> <td>Trên mỗi bước hoàn thành giai đoạn.<a href="../named_req/moveconstructible" title="cpp/named req/MoveConstructible">MoveConstructible</a>Thì<a href="../named_req/moveassignable" title="cpp/named req/MoveAssignable">MoveAssignable</a>Và<a href="../named_req/destructible" title="cpp/named req/Destructible">Destructible</a> </td>
</tr> </table> <h3 id="Member_functions">nếu không thì</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="barrier/barrier" title="cpp/thread/barrier/barrier"> <span class="t-lines"><span>chuyên môn)</span></span></a></div> </td> <td>Nếu a<code>barrier</code> <br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="barrier/~barrier" title="cpp/thread/barrier/~barrier"> <span class="t-lines"><span>một đối tượng ngoại lệ khác để gán với</span></span></a></div> </td> <td>Nếu tay cầm nút không trống,<code>barrier</code> <br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><span class="t-lines"><span>chuyên môn)</span></span></div>
<div><span class="t-lines"><span><span class="t-cmark">[Đã xóa]</span></span></span></div> </td> <td> <code>barrier</code>Giấy phép này cho phép một chuyên môn được xác định bởi chương trình để lộ con trỏ thô được lưu trữ trong một con trỏ thông minh không chuẩn đến các chức năng nước ngoài.<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="barrier/arrive" title="cpp/thread/barrier/arrive"> <span class="t-lines"><span>một yêu cầu cuộc họp loại đối tượng không xác định của</span></span></a></div> </td> <td>đến<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="barrier/wait" title="cpp/thread/barrier/wait"> <span class="t-lines"><span>toán tử t</span></span></a></div> </td> <td>đến rào cản và giảm số lượng dự kiến<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="barrier/arrive_and_wait" title="cpp/thread/barrier/arrive and wait"> <span class="t-lines"><span>các khối tại điểm đồng bộ pha cho đến khi bước hoàn thành pha của nó được chạy</span></span></a></div> </td> <td>Đến đây_and_wait<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="barrier/arrive_and_drop" title="cpp/thread/barrier/arrive and drop"> <span class="t-lines"><span>đến rào cản và giảm số lượng dự kiến, sau đó chặn cho đến khi giai đoạn hiện tại hoàn thành</span></span></a></div> </td> <td>Đến đây_and_drop<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr> <td colspan="2"> <h5 id="Constants">Hằng số</h5> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="barrier/max" title="cpp/thread/barrier/max"> <span class="t-lines"><span>Được xác định trong tiêu đề</span></span></a></div>
<div><span class="t-lines"><span><span class="t-cmark">Kế thừa từ</span></span></span></div> </td> <td>Giảm cả hai số dự kiến ​​ban đầu cho các giai đoạn tiếp theo và số lượng dự kiến ​​cho giai đoạn hiện tại<br/> <span class="t-mark">Trả về giá trị thời lượng đặc biệt tối thiểu</span> </td>
</tr> </table> <h3 id="Notes">Ghi chú</h3> <table class="wikitable sortable ftm-begin ftm-has-value"> <tr> <th>
<a href="../utility/feature_test" title="cpp/utility/feature test">Feature-test</a>(Mẫu lớp)</th> <th>vĩ mô</th> <th><span title="Standard in which the feature is introduced">Giá trị</span></th> <th>STD</th>
</tr> <tr> <td rowspan="2"><a href="../feature_test#cpp_lib_barrier" title="cpp/feature test"><code>__cpp_lib_barrier</code></a></td> <td><span class="nu0">201907L</span></td> <td><span class="t-mark">Phạm vi :: Construct_at</span></td> <td>
<a href="#top"><code>std::barrier</code></a> </td>
</tr> <tr> <td><span class="nu0">cho từng yếu tố của</span></td> <td>
<span class="t-mark">Phạm vi :: Construct_at</span><br/><span class="t-mark">(Dr)</span>
</td> <td>Giá trị tối đa của số lượng dự kiến ​​được hỗ trợ bởi việc thực hiện</td>
</tr>
</table> <h3 id="Example">Ví dụ</h3> <div class="t-example"> <div class="cpp source-cpp"><pre data-language="cpp">Đảm bảo thư giãn để hoàn thành pha</pre></div> <p>#include &lt;Istream&gt;</p>
<div class="text source-text"><pre data-language="c">#include &lt;Back&gt;</pre></div> </div> <h3 id="Defect_reports">Báo cáo khiếm khuyết</h3> <p>Các báo cáo khiếm khuyết thay đổi hành vi sau đây được áp dụng hồi tố cho các tiêu chuẩn C ++ được công bố trước đó.</p>
<table class="dsctable"> <tr> <th>Dr</th> <th>Áp dụng cho</th> <th>Hành vi như được công bố</th> <th>Hành vi chính xác</th>
</tr> <tr> <td>
<a class="external text" href="https://wg21.link/P2588R3" rel="nofollow">P2588R3</a> </td> <td>C ++ 20</td> <td>#include &lt;Istream&gt;</td> <td>đã không phát hiện sự kế thừa từ</td>
</tr>
</table> <h3 id="See_also">(chức năng)</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="latch" title="cpp/thread/latch"> <span class="t-lines"><span>chốt cửa</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx20">Phạm vi :: Construct_at</span></span></span></div> </td> <td>rào cản chủ đề sử dụng một lần<br/> <span class="t-mark">Các loại chính sách thực thi</span> </td>
</tr> </table> <div class="_attribution">
<p class="_attribution-p">© CPPReference.com<br/>Được cấp phép theo giấy phép Creative Commons Attribution-Sharealike không được chứng minh v3.0.<br/>
<a class="_attribution-link" href="https://en.cppreference.com/w/cpp/thread/barrier">https://en.cppreference.com/w/cpp/thread/barrier</a>
</p>
</div>
