 <h1 class="firstHeading" id="firstHeading">STD :: Hứa</h1> <table class="t-dcl-begin"> <tr class="t-dsc-header"> <th>C Thư viện<code><a href="../header/future" title="cpp/header/future">&lt;future&gt;</a></code> </th> <th> </th> <th> </th> </tr> <tr class="t-dcl t-since-cxx11"> <td> <pre data-language="cpp">mẫu &lt;Class R&gt; Class Promise;</pre>
</td> <td>(1)</td> <td> <span class="t-mark-rev t-since-cxx11">(kể từ C ++ 11)</span> </td> </tr> <tr class="t-dcl t-since-cxx11"> <td> <pre data-language="cpp">Mẫu &lt;Class R&gt; Class Promise &lt;r &amp;&gt;;</pre>
</td> <td>(2)</td> <td> <span class="t-mark-rev t-since-cxx11">(kể từ C ++ 11)</span> </td> </tr> <tr class="t-dcl t-since-cxx11"> <td> <pre data-language="cpp">mẫu &lt;&gt; lời hứa lớp &lt;OvE&gt;;</pre>
</td> <td>(3)</td> <td> <span class="t-mark-rev t-since-cxx11">(kể từ C ++ 11)</span> </td> </tr> </table> <div class="t-li1">
<span class="t-li">1)</span>Mẫu cơ sở.</div> <div class="t-li1">
<span class="t-li">2)</span>Chuyên môn không độc hại, được sử dụng để truyền đạt các đối tượng giữa các luồng.</div> <div class="t-li1">
<span class="t-li">Mẫu &lt;class f, class tuple&gt;</span>Void chuyên môn, được sử dụng để truyền đạt các sự kiện không quốc tịch.</div> <p>lớp HH_MM_SS;<code>std::promise</code>cung cấp một cơ sở để lưu trữ một giá trị hoặc một ngoại lệ sau đó được mua lại không đồng bộ thông qua<code><a href="future" title="cpp/thread/future">std::future</a></code>đối tượng được tạo bởi<code>std::promise</code>sự vật. Lưu ý rằng<code>std::promise</code>Đối tượng chỉ được sử dụng chỉ một lần.</p>
<p>Mỗi lời hứa được liên kết với một<i>trạng thái chia sẻ</i>, trong đó chứa một số thông tin nhà nước và một<i>. Sự chồng chéo của phạm vi được chính thức được phép, nhưng dẫn đến thứ tự không thể đoán trước của kết quả.</i>có thể chưa được đánh giá, đánh giá theo giá trị (có thể là vô hiệu) hoặc được đánh giá là một ngoại lệ. Một lời hứa có thể làm ba điều với trạng thái chia sẻ:</p>
<ul>
<li> <i>sẵn sàng</i>: Lời hứa lưu trữ kết quả hoặc ngoại lệ ở trạng thái chung. Đánh dấu nhà nước đã sẵn sàng và bỏ chặn bất kỳ chủ đề nào đang chờ đợi một tương lai liên quan đến trạng thái chung.</li>
<li> <i>giải phóng</i>: Lời hứa từ bỏ tài liệu tham khảo của nó cho trạng thái chung. Nếu đây là tài liệu tham khảo cuối cùng như vậy, trạng thái chung bị phá hủy. Trừ khi đây là một trạng thái được chia sẻ bởi<code><a href="http://en.cppreference.com/w/cpp/thread/async"><span class="kw2186">Điều đó cho tất cả<span class="me2">không đồng bộ</span></span></a></code>mà chưa sẵn sàng, hoạt động này không chặn.</li>
<li> <i>bỏ rơi</i>: Lời hứa lưu trữ ngoại trừ loại<code><a href="future_error" title="cpp/thread/future error">std::future_error</a></code>với mã lỗi<code><a href="future_errc" title="cpp/thread/future errc">std::future_errc::broken_promise</a></code>, làm cho trạng thái chia sẻ<i>ES đại diện cho biểu hiện phụ phù hợp tương ứng theo trình tự với dấu ngoặc đơn bên trái phân định biểu thức phụ trong regex.</i>, và sau đó<i>phát hành</i>Nó.</li>
</ul> <p>Lời hứa là kết thúc "đẩy" của kênh truyền thông trong tương lai hứa hẹn: hoạt động lưu trữ giá trị ở trạng thái chia sẻ<i>y.store (42, std :: memory_order_relaxed); // d</i>    async (std :: chính sách khởi chạy, chức năng &amp;&amp; f, args &amp;&amp; ... args);<code><a href="../atomic/memory_order" title="cpp/atomic/memory order">std::memory_order</a></code>) lợi nhuận thành công từ bất kỳ chức năng nào đang chờ ở trạng thái chia sẻ (chẳng hạn như<code><a href="future/get" title="cpp/thread/future/get">std::future::get</a></code>). Truy cập đồng thời vào cùng một trạng thái chia sẻ có thể xung đột khác: ví dụ: nhiều người gọi của<code><a href="shared_future/get" title="cpp/thread/shared future/get">std::shared_future::get</a></code>Phải tất cả chỉ được đọc hoặc cung cấp đồng bộ hóa bên ngoài.</p>
<h3 id="Member_functions">nếu không thì</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="promise/promise" title="cpp/thread/promise/promise"> <span class="t-lines"><span>chuyên môn)</span></span></a></div> </td> <td>xây dựng đối tượng hứa hẹn<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="promise/~promise" title="cpp/thread/promise/~promise"> <span class="t-lines"><span>một đối tượng ngoại lệ khác để gán với</span></span></a></div> </td> <td>phá hủy đối tượng hứa hẹn<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="promise/operator=" title="cpp/thread/promise/operator="> <span class="t-lines"><span>chuyên môn)</span></span></a></div> </td> <td>gán trạng thái chia sẻ<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="promise/swap" title="cpp/thread/promise/swap"> <span class="t-lines"><span>Được xác định trong tiêu đề</span></span></a></div> </td> <td>hoán đổi hai đối tượng hứa hẹn<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr> <td colspan="2"> <h5 id="Getting_the_result">Nhận kết quả</h5> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="promise/get_future" title="cpp/thread/promise/get future"> <span class="t-lines"><span>hoán đổi hai đối tượng nhiệm vụ</span></span></a></div> </td> <td>Hiện nay<a href="future" title="cpp/thread/future"><code>future</code></a>get_future<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr> <td colspan="2"> <h5 id="Setting_the_result">Thiết lập kết quả</h5> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="promise/set_value" title="cpp/thread/promise/set value"> <span class="t-lines"><span>set_value</span></span></a></div> </td> <td>Đặt kết quả thành giá trị cụ thể<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="promise/set_value_at_thread_exit" title="cpp/thread/promise/set value at thread exit"> <span class="t-lines"><span>#include &lt;Cassert&gt;</span></span></a></div> </td> <td>#include &lt;điều kiện_varable&gt;<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="promise/set_exception" title="cpp/thread/promise/set exception"> <span class="t-lines"><span>set_exception</span></span></a></div> </td> <td>đặt kết quả để chỉ ra một ngoại lệ<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="promise/set_exception_at_thread_exit" title="cpp/thread/promise/set exception at thread exit"> <span class="t-lines"><span>set_exception_at_thread_exit</span></span></a></div> </td> <td>Đặt kết quả để chỉ ra một ngoại lệ trong khi chỉ cung cấp thông báo tại thoát luồng<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> </table> <h3 id="Non-member_functions">Các chức năng không phải thành viên</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="promise/swap2" title="cpp/thread/promise/swap2"> <span class="t-lines"><span>chuyên về<span class="t-dsc-small">Thuật toán</span></span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">unininitialized_copy_n</span></span></span></div> </td> <td>quá tải<code><a href="../algorithm/swap" title="cpp/algorithm/swap">std::swap</a></code>Thuật toán<br/> <span class="t-mark">tạo một đối tượng tại một địa chỉ nhất định</span> </td>
</tr> </table> <h3 id="Helper_classes">Lớp học trợ giúp</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="promise/uses_allocator" title="cpp/thread/promise/uses allocator"> <span class="t-lines"><span>Trả về hàm so sánh các phím trong các đối tượng thuộc loại<span class="t-dsc-small">&lt;std :: Hứa&gt;</span></span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">unininitialized_copy_n</span></span></span></div> </td> <td>quá tải<code><a href="../memory/uses_allocator" title="cpp/memory/uses allocator">std::uses_allocator</a></code>Truy cập trực tiếp vào thùng chứa các khóa cơ bản<br/> <span class="t-mark">(Chuyên ngành mẫu lớp)</span> </td>
</tr> </table> <h3 id="Example">Ví dụ</h3> <div class="t-example">
<p>Ví dụ này cho thấy cách<code>promise&lt;int&gt;</code>có thể được sử dụng làm tín hiệu giữa các luồng.</p>
<div class="cpp source-cpp"><pre data-language="cpp">#include &lt;Brono&gt;</pre></div> <p>Nếu (sai)</p>
<div class="text source-text"><pre data-language="c">#include &lt;Tương lai&gt;</pre></div> </div> <div class="_attribution">
<p class="_attribution-p">© CPPReference.com<br/>Được cấp phép theo giấy phép Creative Commons Attribution-Sharealike không được chứng minh v3.0.<br/>
<a class="_attribution-link" href="https://en.cppreference.com/w/cpp/thread/promise">https://en.cppreference.com/w/cpp/thread/promise</a>
</p>
</div>
