 <h1 class="firstHeading" id="firstHeading">std :: current_exception</h1> <table class="t-dcl-begin"> <tr class="t-dsc-header"> <th>C Thư viện<code><a href="../header/exception" title="cpp/header/exception">&lt;exception&gt;</a></code> </th> <th> </th> <th> </th> </tr> <tr class="t-dcl t-since-cxx11"> <td> <pre data-language="cpp">STD :: Exception_ptr current_exception () NoExcept;</pre>
</td> <td class="t-dcl-nopad"> </td> <td> <span class="t-mark-rev t-since-cxx11">(kể từ C ++ 11)</span> </td> </tr> </table> <p>Nếu được gọi trong quá trình xử lý ngoại lệ (thông thường, trong một<code>catch</code>mệnh đề), nắm bắt đối tượng ngoại lệ hiện tại và tạo<code><a href="exception_ptr" title="cpp/error/exception ptr">std::exception_ptr</a></code>Điều đó chứa một bản sao hoặc tham chiếu đến đối tượng ngoại lệ đó (tùy thuộc vào việc thực hiện). Đối tượng được tham chiếu vẫn có giá trị ít nhất miễn là có một<code>exception_ptr</code>Đối tượng đề cập đến nó.</p>
<p>Nếu việc thực hiện chức năng này yêu cầu một cuộc gọi đến<code>new</code>và cuộc gọi không thành công, con trỏ trả về sẽ giữ một tham chiếu đến một thể hiện<code><a href="../memory/new/bad_alloc" title="cpp/memory/new/bad alloc">std::bad_alloc</a></code>.</p>
<p>Nếu việc thực hiện chức năng này yêu cầu sao chép đối tượng ngoại lệ bị bắt và hàm tạo bản sao của nó ném một ngoại lệ, con trỏ được trả về sẽ giữ một tham chiếu đến ngoại lệ ném. Nếu hàm tạo bản sao của đối tượng ngoại lệ ném cũng ném, con trỏ được trả về có thể giữ một tham chiếu đến một thể hiện của<code><a href="bad_exception" title="cpp/error/bad exception">std::bad_exception</a></code>Để phá vỡ vòng lặp vô tận.</p>
<p>Nếu chức năng được gọi khi không có ngoại lệ nào được xử lý, thì trống<code><a href="exception_ptr" title="cpp/error/exception ptr">std::exception_ptr</a></code>bất kể</p>
<p>Chức năng này có thể được gọi trong một<code><a href="terminate_handler" title="cpp/error/terminate handler">std::terminate_handler</a></code>để lấy ra ngoại lệ đã kích động lời cầu khẩn của<code><a href="terminate" title="cpp/error/terminate">std::terminate</a></code>.</p>
<h3 id="Parameters">) với giá trị ban đầu</h3> <p>Gán cho đã cho</p>
<h3 id="Return_value">phải sao cho một đối tượng thuộc loại</h3> <p>Một ví dụ của<code><a href="exception_ptr" title="cpp/error/exception ptr">std::exception_ptr</a></code>giữ một tham chiếu đến đối tượng ngoại lệ hoặc bản sao của đối tượng ngoại lệ hoặc một thể hiện<code><a href="../memory/new/bad_alloc" title="cpp/memory/new/bad alloc">std::bad_alloc</a></code>hoặc một ví dụ của<code><a href="bad_exception" title="cpp/error/bad exception">std::bad_exception</a></code>.</p>
<h3 id="Notes">Ghi chú</h3> <p>Về các triển khai theo sau<a class="external text" href="https://itanium-cxx-abi.github.io/cxx-abi/abi.html" rel="nofollow">Itanium C++ ABI</a>(Gcc, clang, v.v.), các ngoại lệ được phân bổ trên đống khi ném (ngoại trừ<code><a href="../memory/new/bad_alloc" title="cpp/memory/new/bad alloc">std::bad_alloc</a></code>Trong một số trường hợp), và chức năng này chỉ đơn giản là tạo con trỏ thông minh tham chiếu đối tượng được phân bổ trước đó, trên MSVC, các ngoại lệ được phân bổ trên ngăn xếp khi ném và chức năng này thực hiện phân bổ heap và sao chép đối tượng ngoại lệ.</p>
<p>Trên Windows trong môi trường CLR được quản lý<a class="external autonumber" href="https://learn.microsoft.com/en-us/cpp/dotnet/exceptions-in-cpp-cli" rel="nofollow">[1]</a>, việc thực hiện sẽ lưu trữ một<code><a href="bad_exception" title="cpp/error/bad exception">std::bad_exception</a></code>Khi ngoại lệ hiện tại là một ngoại lệ được quản lý (<a class="external autonumber" href="https://github.com/microsoft/STL/blob/65aab97a8e75e7ba409002e518ed799006dfb285/stl/src/excptptr.cpp#L367" rel="nofollow">[2]</a>). Lưu ý rằng<code>catch(...)</code>Catches cũng được quản lý ngoại lệ:</p>
<div class="cpp source-cpp"><pre data-language="cpp">#include &lt;Ngoại lệ&gt;</pre></div> <h3 id="Example">Ví dụ</h3>
<div class="t-example"> <div class="cpp source-cpp"><pre data-language="cpp"> </pre></div> <p>#include &lt;Istream&gt;</p>
<div class="text source-text"><pre data-language="c">int main ()</pre></div> </div> <h3 id="See_also">(chức năng)</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="exception_ptr" title="cpp/error/exception ptr"> <span class="t-lines"><span>Exception_ptr</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">unininitialized_copy_n</span></span></span></div> </td> <td>Loại con trỏ được chia sẻ để xử lý các đối tượng ngoại lệ<br/> <span class="t-mark">(typedef)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="rethrow_exception" title="cpp/error/rethrow exception"> <span class="t-lines"><span>rethrow_exception</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">unininitialized_copy_n</span></span></span></div> </td> <td>ném ngoại lệ từ một<code><a href="exception_ptr" title="cpp/error/exception ptr">std::exception_ptr</a></code> <br/> <span class="t-mark">Tìm kiếm một mảng cho một yếu tố thuộc loại không xác định</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="make_exception_ptr" title="cpp/error/make exception ptr"> <span class="t-lines"><span>make_exception_ptr</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">unininitialized_copy_n</span></span></span></div> </td> <td>tạo ra một<code><a href="exception_ptr" title="cpp/error/exception ptr">std::exception_ptr</a></code>từ một đối tượng ngoại lệ<br/> <span class="t-mark">tạo một đối tượng tại một địa chỉ nhất định</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="uncaught_exception" title="cpp/error/uncaught exception"> <span class="t-lines"><span>Uncaught_Exception</span><span>Uncaught_exceptions</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-until-cxx20">(Đã xóa trong C ++ 20)</span></span><span><span class="t-mark-rev t-since-cxx17">Dest_at</span></span></span></div> </td> <td>Kiểm tra nếu xử lý ngoại lệ hiện đang được tiến hành<br/> <span class="t-mark">Tìm kiếm một mảng cho một yếu tố thuộc loại không xác định</span> </td>
</tr> </table> <div class="_attribution">
<p class="_attribution-p">© CPPReference.com<br/>Được cấp phép theo giấy phép Creative Commons Attribution-Sharealike không được chứng minh v3.0.<br/>
<a class="_attribution-link" href="https://en.cppreference.com/w/cpp/error/current_exception">https://en.cppreference.com/w/cpp/error/current_exception</a>
</p>
</div>
