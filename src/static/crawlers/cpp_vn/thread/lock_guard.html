 <h1 class="firstHeading" id="firstHeading">std :: lock_guard</h1> <table class="t-dcl-begin"> <tr class="t-dsc-header"> <th>C Thư viện<code><a href="../header/mutex" title="cpp/header/mutex">&lt;mutex&gt;</a></code> </th> <th> </th> <th> </th> </tr> <tr class="t-dcl t-since-cxx11"> <td> <pre data-language="cpp">Mẫu &lt;Class Mutex&gt;</pre>
</td> <td class="t-dcl-nopad"> </td> <td> <span class="t-mark-rev t-since-cxx11">(kể từ C ++ 11)</span> </td> </tr> </table> <p>Lớp học<code>lock_guard</code>lớp lock_guard;<a href="../language/raii" title="cpp/language/raii">RAII-style</a>là một trình bao bọc Mutex cung cấp một tiện lợi</p>
<p>Khi a<code>lock_guard</code>Cơ chế sở hữu một mutex trong suốt thời gian của một khối phạm vi.<code>lock_guard</code>Đối tượng được tạo ra, nó cố gắng sở hữu mutex mà nó được đưa ra. Khi điều khiển rời khỏi phạm vi mà<code>lock_guard</code>đối tượng đã được tạo,</p>
<p>Các<code>lock_guard</code>được phá hủy và Mutex được phát hành.</p>
<h3 id="Template_parameters">là không xác định.</h3> <table class="t-par-begin"> <tr class="t-par"> <td>Mutex</td> <td>-</td> <td>Lớp học là không thể sao chép.<a href="../named_req/basiclockable" title="cpp/named req/BasicLockable">BasicLockable</a>yêu cầu</td>
</tr>
</table> <h3 id="Member_types">nhà điều hành ()</h3> <table class="t-dsc-begin"> <tr class="t-dsc-hitem"> <th>ATOMIC_UNSIGNED_LOCK_FREE</th> <th>Sự định nghĩa</th>
</tr> <tr class="t-dsc"> <td> <code>mutex_type</code> </td> <td>Mutex</td>
</tr> </table> <h3 id="Member_functions">nếu không thì</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="lock_guard/lock_guard" title="cpp/thread/lock guard/lock guard"> <span class="t-lines"><span>chuyên môn)</span></span></a></div> </td> <td>Nếu a<code>lock_guard</code>Loại mutex để khóa. Loại phải đáp ứng<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="lock_guard/~lock_guard" title="cpp/thread/lock guard/~lock guard"> <span class="t-lines"><span>một đối tượng ngoại lệ khác để gán với</span></span></a></div> </td> <td>với kích thước lớn hơn không làm mất hiệu lực bất kỳ tài liệu tham khảo nào về các yếu tố của deque.<code>lock_guard</code>, tùy chọn khóa mutex đã cho<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> <tr class="t-dsc"> <td> <div><span class="t-lines"><span>chuyên môn)</span></span></div>
<div><span class="t-lines"><span><span class="t-cmark">[Đã xóa]</span></span></span></div> </td> <td>Không được xác nhận sao chép<br/> <span class="t-mark">(chức năng thành viên công cộng)</span> </td>
</tr> </table> <h3 id="Notes">Ghi chú</h3> <p>đối tượng, mở khóa Mutex cơ bản<code>lock_guard</code>Lỗi bắt đầu phổ biến là "quên" để đưa ra một<code>std::lock_guard(mtx);</code>Biến một tên, ví dụ:<code>lock_guard</code>(mặc định nào xây dựng một<code>mtx</code>*(d_first + 1) = *(đầu tiên + 1) - *(đầu tiên);<code>std::lock_guard{mtx};</code>biến tên</p>
<table class="t-rev-begin"> <tr class="t-rev t-since-cxx17">
<td> <p><a href="scoped_lock" title="cpp/thread/scoped lock"><code>std::scoped_lock</code></a>(nơi xây dựng một đối tượng prvalue ngay lập tức bị phá hủy), do đó không thực sự xây dựng một khóa chứa một mutex cho phần còn lại của phạm vi.<code>lock_guard</code>cung cấp một giải pháp thay thế cho</p>
</td> <td><span class="t-mark-rev t-since-cxx17">(C ++ 20)</span></td>
</tr> </table> <h3 id="Example">Ví dụ</h3> <div class="t-example">
<p>Điều đó cung cấp khả năng khóa nhiều mutexes bằng thuật toán tránh bế tắc.</p>
<div class="cpp source-cpp"><pre data-language="cpp">Thể hiện sự gia tăng an toàn và không an toàn của một biến dễ bay hơi bởi hai luồng.</pre></div> <p>#include &lt;Istream&gt;</p>
<div class="text source-text"><pre data-language="c">#include &lt;Istream&gt;</pre></div> </div> <h3 id="Defect_reports">Báo cáo khiếm khuyết</h3> <p>Các báo cáo khiếm khuyết thay đổi hành vi sau đây được áp dụng hồi tố cho các tiêu chuẩn C ++ được công bố trước đó.</p>
<table class="dsctable"> <tr> <th>Dr</th> <th>Áp dụng cho</th> <th>Hành vi như được công bố</th> <th>Hành vi chính xác</th>
</tr> <tr> <td>
<a class="external text" href="https://cplusplus.github.io/LWG/issue2981" rel="nofollow">LWG 2981</a> </td> <td>C ++ 17</td> <td>#include &lt;Prutex&gt;<code>lock_guard&lt;Mutex&gt;</code> </td> <td>#include &lt;Istream&gt;</td>
</tr>
</table> <h3 id="See_also">(chức năng)</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="unique_lock" title="cpp/thread/unique lock"> <span class="t-lines"><span>độc đáo_lock</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">unininitialized_copy_n</span></span></span></div> </td> <td>Thực hiện trình bao bọc quyền sở hữu Mutex có thể di chuyển<br/> <span class="t-mark">Kiểm tra xem một lớp có đại diện cho chính sách thực thi không</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="scoped_lock" title="cpp/thread/scoped lock"> <span class="t-lines"><span>scoped_lock</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">Dest_at</span></span></span></div> </td> <td>Trình bao bọc Raii không tránh bế tắc cho nhiều mutexes<br/> <span class="t-mark">Kiểm tra xem một lớp có đại diện cho chính sách thực thi không</span> </td>
</tr> </table> <div class="_attribution">
<p class="_attribution-p">© CPPReference.com<br/>Được cấp phép theo giấy phép Creative Commons Attribution-Sharealike không được chứng minh v3.0.<br/>
<a class="_attribution-link" href="https://en.cppreference.com/w/cpp/thread/lock_guard">https://en.cppreference.com/w/cpp/thread/lock_guard</a>
</p>
</div>
