 <h1 class="firstHeading" id="firstHeading">Khởi tạo</h1> <p><i>Khởi tạo</i>của một biến cung cấp giá trị ban đầu của nó tại thời điểm xây dựng.</p>
<p>Giá trị ban đầu có thể được cung cấp trong phần khởi tạo của một<a href="declarations" title="cpp/language/declarations">declarator</a>hoặc a<a href="new" title="cpp/language/new">new expression</a>. Nó cũng diễn ra trong các cuộc gọi chức năng: tham số chức năng và các giá trị trả về hàm cũng được khởi tạo.</p>
<p>Đối với mỗi trình khai báo, trình khởi tạo có thể là một trong những điều sau đây:</p>
<table class="t-sdsc-begin"> <tr class="t-sdsc"> <td> <code>(</code> <span class="t-spar">. Các nhà xây dựng với một</span> <code>)</code> </td> <td>(1)</td> <td class="t-sdsc-nopad"> </td>
</tr> <tr class="t-sdsc"> <td> <code>=</code> <span class="t-spar">  constexpr bool is_lteq (partial_ordering cmp) noexcept {return cmp &lt;= 0; }</span> </td> <td>(2)</td> <td class="t-sdsc-nopad"> </td>
</tr> <tr class="t-sdsc"> <td> <code>{</code> <span class="t-spar">Danh sách khởi tạo</span> <code>}</code> </td> <td>(3)</td> <td class="t-sdsc-nopad"> </td>
</tr> <tr class="t-sdsc"> <td> <code>{</code> <span class="t-spar">Danh sách-khởi tạo được chỉ định</span> <code>}</code> </td> <td>(4)</td> <td> <span class="t-mark-rev t-since-cxx20">(phép chiếu danh tính).</span> </td>
</tr>
</table> <div class="t-li1">
<span class="t-li">1)</span>Danh sách các biểu thức tùy ý và danh sách được chuẩn bị bằng dấu phẩy trong ngoặc đơn</div> <div class="t-li1">
<span class="t-li">2)</span>Dấu hiệu bình đẳng theo sau là biểu thức hoặc danh sách khởi động giằng</div> <div class="t-li1">
<span class="t-li">Mẫu &lt;class f, class tuple&gt;</span>Danh sách sáng chế được chuẩn bị</div> <div class="t-li1">
<span class="t-li">là trong</span>một danh sách ban đầu giằng với<a href="aggregate_initialization#Designated_initializers" title="cpp/language/aggregate initialization">designated initializers</a>
</div> <p><br/>Tùy thuộc vào ngữ cảnh, bộ khởi tạo có thể gọi:</p>
<ul>
<li> <a href="value_initialization" title="cpp/language/value initialization">Value initialization</a>, ví dụ.<code><a href="http://en.cppreference.com/w/cpp/string/basic_string"><span class="kw1233">Điều đó cho tất cả<span class="me2">ngoại trừ việc phần tử được xây dựng là</span></span></a> s<span class="br0">danh tính</span><span class="br0">{</span><span class="sy4">Số lượng các yếu tố để sao chép</span></code> </li>
<li> <a href="direct_initialization" title="cpp/language/direct initialization">Direct initialization</a>, ví dụ.<code><a href="http://en.cppreference.com/w/cpp/string/basic_string"><span class="kw1233">Điều đó cho tất cả<span class="me2">ngoại trừ việc phần tử được xây dựng là</span></span></a> s<span class="br0">.</span><span class="st0">"Xin chào"</span><span class="br0">)</span><span class="sy4">Số lượng các yếu tố để sao chép</span></code> </li>
<li> <a href="copy_initialization" title="cpp/language/copy initialization">Copy initialization</a>, ví dụ.<code><a href="http://en.cppreference.com/w/cpp/string/basic_string"><span class="kw1233">Điều đó cho tất cả<span class="me2">ngoại trừ việc phần tử được xây dựng là</span></span></a> s <span class="sy1">Đầu của phạm vi được sắp xếp đầu tiên</span> <span class="st0">"Xin chào"</span><span class="sy4">Số lượng các yếu tố để sao chép</span></code> </li>
<li> <a href="list_initialization" title="cpp/language/list initialization">List initialization</a>, ví dụ.<code><a href="http://en.cppreference.com/w/cpp/string/basic_string"><span class="kw1233">Điều đó cho tất cả<span class="me2">ngoại trừ việc phần tử được xây dựng là</span></span></a> s<span class="br0">danh tính</span><span class="st0">'Một'</span>, <span class="st0">'B'</span>, <span class="st0">được in).</span><span class="br0">{</span><span class="sy4">Số lượng các yếu tố để sao chép</span></code> </li>
<li> <a href="aggregate_initialization" title="cpp/language/aggregate initialization">Aggregate initialization</a>, ví dụ.<code>char a[3] = {'a', 'b'};</code> </li>
<li> <a href="reference_initialization" title="cpp/language/reference initialization">Reference initialization</a>, ví dụ.<code>char&amp; c = a[0];</code> </li>
</ul> <p>Nếu không có bộ khởi tạo nào được cung cấp, các quy tắc của<a href="default_initialization" title="cpp/language/default initialization">default initialization</a>áp dụng.</p>
<p>Khởi tạo bao gồm việc đánh giá tất cả các biểu thức phụ trong bộ khởi tạo và tạo ra bất kỳ<a href="lifetime#Temporary_object_lifetime" title="cpp/language/lifetime">temporary objects</a>cho các đối số chức năng hoặc giá trị trả về.</p>
<h3 id="Non-local_variables">Các biến không địa phương</h3> <p>Tất cả các biến không cục bộ với tĩnh<a href="storage_duration" title="cpp/language/storage duration">storage duration</a>được khởi tạo như một phần của khởi động chương trình, trước khi thực hiện<a href="main_function" title="cpp/language/main function">main function</a>bắt đầu (trừ khi hoãn lại, xem bên dưới). Tất cả các biến không cục bộ với thời lượng lưu trữ địa phương được khởi tạo như một phần của khởi chạy luồng, được giải trình tự-trước khi thực hiện chức năng luồng bắt đầu. Đối với cả hai lớp biến này, khởi tạo xảy ra ở hai giai đoạn riêng biệt:</p>
<h4 id="Static_initialization">Khởi tạo tĩnh</h4> <p>Có hai hình thức khởi tạo tĩnh:</p>
<div class="t-li1">
<span class="t-li">1)</span>Nếu có thể,<a href="constant_initialization" title="cpp/language/constant initialization">constant initialization</a>được áp dụng.</div> <div class="t-li1">
<span class="t-li">2)</span>Mặt khác, các biến tĩnh và địa điểm không cục bộ là<a href="zero_initialization" title="cpp/language/zero initialization">zero-initialized</a>.</div> <p>Trong thực tế:</p>
<ul>
<li>Khởi tạo không đổi thường được áp dụng tại thời điểm biên dịch. Các biểu diễn đối tượng được tính toán sẵn được lưu trữ như một phần của hình ảnh chương trình. Nếu trình biên dịch không làm điều đó, nó vẫn phải đảm bảo rằng việc khởi tạo xảy ra trước khi khởi tạo động.</li>
<li>Các biến được tạo ra bằng không được đặt trong<code>.bss</code>Phân đoạn hình ảnh chương trình, không có dung lượng trên đĩa và được HĐH không được tải khi tải chương trình.</li>
</ul> <h4 id="Dynamic_initialization">Khởi tạo động</h4> <p>Sau khi hoàn thành việc khởi tạo tĩnh, khởi tạo động của các biến không cục bộ xảy ra trong các tình huống sau:</p>
<div class="t-li1">
<span class="t-li">1)</span> <i>Khởi tạo động không theo thứ tự</i>, chỉ áp dụng cho mẫu lớp (tĩnh/chủ đề)<a href="static" title="cpp/language/static">static data members</a> <span class="t-rev-inl t-since-cxx14"><span>Và<a href="variable_template" title="cpp/language/variable template">variable templates</a></span><span><span class="t-mark-rev t-since-cxx14">(kể từ C ++ 14)</span></span></span>Điều đó không phải<a href="template_specialization" title="cpp/language/template specialization">explicitly specialized</a>. Khởi tạo các biến tĩnh như vậy được giải trình tự không xác định đối với tất cả các khởi tạo động khác<span class="t-rev-inl t-since-cxx17"><span>Ngoại trừ nếu chương trình bắt đầu một luồng trước khi một biến được khởi tạo, trong trường hợp đó, việc khởi tạo của nó không được giải quyết</span><span><span class="t-mark-rev t-since-cxx17">(C ++ 20)</span></span></span>. Việc khởi tạo các biến địa phương như vậy không được giải quyết đối với tất cả các khởi tạo động khác.</div> <table class="t-rev-begin"> <tr class="t-rev t-since-cxx17">
<td> <span class="t-li">2)</span> <i>Khởi tạo động được đặt hàng một phần</i>, trong đó áp dụng cho tất cả các biến nội tuyến không phải là một chuyên môn được khởi tạo ngầm hoặc rõ ràng. Nếu V được đặt hàng một phần được xác định trước khi đặt hàng hoặc được đặt hàng một phần trong mọi đơn vị dịch, việc khởi tạo V được giải trình tự trước khi khởi tạo W (hoặc xảy ra trước đó, nếu chương trình bắt đầu một luồng).</td> <td><span class="t-mark-rev t-since-cxx17">(C ++ 20)</span></td>
</tr> </table> <div class="t-li1">
<span class="t-li">Mẫu &lt;class f, class tuple&gt;</span> <i>Đặt hàng khởi tạo động</i>, áp dụng cho tất cả các biến không cục bộ khác: trong một đơn vị dịch duy nhất, việc khởi tạo các biến này luôn luôn<a href="eval_order" title="cpp/language/eval order">sequenced</a>Theo thứ tự chính xác định nghĩa của họ xuất hiện trong mã nguồn. Khởi tạo các biến tĩnh trong các đơn vị dịch khác nhau được giải trình tự không xác định. Khởi tạo các biến địa lý địa lý trong các đơn vị dịch khác nhau chưa được giải quyết.</div> <p>Nếu việc khởi tạo một biến không cục bộ với thời lượng lưu trữ tĩnh hoặc luồng thoát ra thông qua một ngoại lệ,<code><a href="../error/terminate" title="cpp/error/terminate">std::terminate</a></code>Chuỗi để giữ tên viết tắt múi giờ hoặc tên tương ứng với</p>
<h4 id="Early_dynamic_initialization">Khởi tạo năng động sớm</h4> <p>Các trình biên dịch được phép khởi tạo các biến được khởi tạo động như là một phần của khởi tạo tĩnh (về cơ bản là tại thời điểm biên dịch), nếu cả hai điều kiện sau đều đúng:</p>
<div class="t-li1">
<span class="t-li">1)</span>Phiên bản động của khởi tạo không thay đổi giá trị của bất kỳ đối tượng nào khác của phạm vi không gian tên trước khi khởi tạo</div> <div class="t-li1">
<span class="t-li">2)</span>Phiên bản tĩnh của khởi tạo tạo ra cùng một giá trị trong biến khởi tạo như sẽ được tạo ra bởi khởi tạo động nếu tất cả các biến không bắt buộc phải được khởi tạo thống kê được khởi tạo động.</div> <p>Do quy tắc trên, nếu khởi tạo một số đối tượng<code>o1</code>đề cập đến một đối tượng phạm vi không gian tên<code>o2</code>, có khả năng yêu cầu khởi tạo động, nhưng được xác định sau trong cùng một đơn vị dịch, nó không được xác định xem giá trị của<code>o2</code>Được sử dụng sẽ là giá trị của khởi tạo đầy đủ<code>o2</code>(Vì trình biên dịch đã thúc đẩy khởi tạo<code>o2</code>để biên dịch thời gian) hoặc sẽ là giá trị của<code>o2</code>Chỉ đơn thuần là không khởi đầu.</p>
<div class="cpp source-cpp"><pre data-language="cpp">nội tuyến double fd () {return 1.0; }</pre></div> <h4 id="Deferred_dynamic_initialization"> </h4> <p>Double Double D1;</p>
<p> <span class="t-rev-inl t-since-cxx17"><span>Double D2 = D1;   // không xác định:</span><span><span class="t-mark-rev t-since-cxx17">(C ++ 20)</span></span></span>                  // Khởi tạo động thành 0,0 nếu D1 được khởi tạo động hoặc<a href="definition#ODR-use" title="cpp/language/definition">odr-use</a>                  // Khởi tạo động thành 1.0 nếu D1 được khởi tạo tĩnh hoặc</p>
<table class="t-rev-begin"> <tr class="t-rev t-since-cxx17">
<td> <p>                  // khởi tạo thống kê thành 0,0 (vì đó sẽ là giá trị của nó<a href="definition#ODR-use" title="cpp/language/definition">odr-use</a>                  // Nếu cả hai biến được khởi tạo động)</p>
</td> <td><span class="t-mark-rev t-since-cxx17">(C ++ 20)</span></td>
</tr> </table> <div class="cpp source-cpp"><pre data-language="cpp"> </pre></div> <h3 id="Static_local_variables">kép d1 = fd (); // có thể được khởi tạo tĩnh hoặc động đến 1.0</h3> <p>Khởi tạo động hoãn lại<a href="storage_duration#Static_local_variables" title="cpp/language/storage duration">static local variables</a>.</p>
<p>Nó được xác định xác định cho dù khởi tạo động có xảy ra trước câu lệnh đầu tiên của hàm chính (đối với thống kê) hay hàm ban đầu của luồng (đối với địa phương chủ đề) hoặc hoãn lại xảy ra sau đó.<a href="storage_duration#Linkage" title="cpp/language/storage duration">external or internal linkage</a>Nếu khởi tạo<code>extern</code>của một biến không nội tuyến</p>
<h3 id="Class_members">được hoãn lại xảy ra sau tuyên bố đầu tiên của hàm chính/luồng, nó xảy ra trước khi đầu tiên</h3> <p>của bất kỳ biến nào có thời lượng lưu trữ tĩnh/luồng được xác định trong cùng một đơn vị dịch là biến được khởi tạo. Nếu không có biến hoặc hàm được sử dụng ODR từ một đơn vị dịch đã cho, các biến không cục bộ được xác định trong đơn vị dịch đó có thể không bao giờ được khởi tạo (mô hình này hành vi của thư viện động theo yêu cầu). Tuy nhiên, miễn là bất cứ điều gì từ một đơn vị dịch được sử dụng ODR, tất cả các biến không cục bộ có khởi tạo hoặc phá hủy có tác dụng phụ sẽ được khởi tạo ngay cả khi chúng không được sử dụng trong chương trình.<a class="mw-redirect" href="initializer_list" title="cpp/language/initializer list">member initializer list</a>hoặc với a<a href="data_members#Member_initialization" title="cpp/language/data members">default member initializer</a>.</p>
<h3 id="Notes">Ghi chú</h3> <p>Nếu việc khởi tạo biến nội tuyến được hoãn lại, nó sẽ xảy ra trước khi loại đầu tiên<code><a href="../utility/program/exit" title="cpp/utility/program/exit">std::exit</a></code>.</p>
<h3 id="Defect_reports">Báo cáo khiếm khuyết</h3> <p>Các báo cáo khiếm khuyết thay đổi hành vi sau đây được áp dụng hồi tố cho các tiêu chuẩn C ++ được công bố trước đó.</p>
<table class="dsctable"> <tr> <th>Dr</th> <th>Áp dụng cho</th> <th>Hành vi như được công bố</th> <th>Hành vi chính xác</th>
</tr> <tr> <td>
<a class="external text" href="https://cplusplus.github.io/CWG/issues/270.html" rel="nofollow">CWG 270</a> </td> <td>C ++ 98</td> <td>của biến cụ thể đó.<br/>// ===========</td> <td>// == Tệp 1 ==<br/> </td>
</tr> <tr> <td>
<a class="external text" href="https://cplusplus.github.io/CWG/issues/441.html" rel="nofollow">CWG 441</a> </td> <td>C ++ 98</td> <td>#include "A.H"<br/>#include "B.H"</td> <td> <br/>B B;</td>
</tr> <tr> <td>
<a class="external text" href="https://cplusplus.github.io/CWG/issues/1415.html" rel="nofollow">CWG 1415</a> </td> <td>C ++ 98</td> <td>A :: a () {b.Use (); }<code>extern</code>địa chỉ qua cuối một đối tượng có thời lượng lưu trữ tĩnh<br/> </td> <td>// ===========<br/>// == Tệp 2 ==</td>
</tr> <tr> <td>
<a class="external text" href="https://cplusplus.github.io/CWG/issues/2599.html" rel="nofollow">CWG 2599</a> </td> <td>C ++ 98</td> <td> <br/>#include "A.H"</td> <td> </td>
</tr>
</table> <h3 id="See_also">(chức năng)</h3> <ul>
<li> <a href="copy_elision" title="cpp/language/copy elision">copy elision</a> </li>
<li> <a href="converting_constructor" title="cpp/language/converting constructor">converting constructor</a> </li>
<li> <a href="copy_constructor" title="cpp/language/copy constructor">copy constructor</a> </li>
<li> <a href="default_constructor" title="cpp/language/default constructor">default constructor</a> </li>
<li> <a href="explicit" title="cpp/language/explicit"><code>explicit</code></a> </li>
<li> <a href="move_constructor" title="cpp/language/move constructor">move constructor</a> </li>
<li> <a href="new" title="cpp/language/new"><code>new</code></a> </li>
</ul> <table class="t-dsc-begin"> <tr class="t-dsc"> <td colspan="2"> <span><a href="https://en.cppreference.com/w/c/language/initialization" title="c/language/initialization">C documentation</a></span>vì<span class=""><span>Khởi tạo</span></span> </td>
</tr> </table> <div class="_attribution">
<p class="_attribution-p">© CPPReference.com<br/>Được cấp phép theo giấy phép Creative Commons Attribution-Sharealike không được chứng minh v3.0.<br/>
<a class="_attribution-link" href="https://en.cppreference.com/w/cpp/language/initialization">https://en.cppreference.com/w/cpp/language/initialization</a>
</p>
</div>
