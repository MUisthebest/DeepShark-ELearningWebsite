 <h1 class="firstHeading" id="firstHeading">Tên nhân vật phổ quát không được phép</h1> <p>Tệp nguồn C ++ được trình biên dịch xử lý như thể các giai đoạn sau diễn ra, theo thứ tự chính xác này:</p>
<h3 id="Phase_1">Giai đoạn 1</h3> <table class="t-rev-begin"> <tr class="t-rev t-until-cxx23">
<td> <span class="t-li">1)</span>Các byte riêng lẻ của tệp mã nguồn được ánh xạ (theo cách xác định thực hiện) đến các ký tự của<a href="charset#Basic_source_character_set" title="cpp/language/charset">basic source character set</a>. Cụ thể, các chỉ số cuối dòng phụ thuộc OS được thay thế bằng các ký tự mới.<span class="t-li">2)</span> <span class="t-rev-inl t-since-cxx11"><span>Tập hợp các ký tự tệp nguồn được chấp nhận là do triển khai xác định</span><span><span class="t-mark-rev t-since-cxx11">(kể từ C ++ 11)</span></span></span>. Bất kỳ ký tự tệp nguồn nào không thể được ánh xạ tới một ký tự trong<a href="charset#Basic_source_character_set" title="cpp/language/charset">basic source character set</a>được thay thế bởi nó<a href="escape" title="cpp/language/escape">universal character name</a>(trốn thoát cùng<code>\u</code>hoặc<code>\U</code>) hoặc bằng một số hình thức được xác định bằng thực hiện được xử lý tương đương.<table class="t-rev-begin"> <tr class="t-rev t-until-cxx17">
<td> <span class="t-li">Mẫu &lt;class f, class tuple&gt;</span> <a href="operator_alternative" title="cpp/language/operator alternative">Trigraph sequences</a>được thay thế bằng các biểu diễn đặc trưng đơn tương ứng.</td> <td><span class="t-mark-rev t-until-cxx17">xáo trộn</span></td>
</tr> </table> </td> <td><span class="t-mark-rev t-until-cxx23">(Cho đến C ++ 23)</span></td>
</tr> <tr class="t-rev t-since-cxx23">
<td> <p>Các tệp đầu vào là một chuỗi các đơn vị mã UTF-8 (tệp UTF-8) được đảm bảo sẽ được hỗ trợ. Tập hợp các loại tệp đầu vào được hỗ trợ khác được xác định bằng triển khai. Nếu tập hợp không trống, loại tệp đầu vào được xác định theo cách xác định thực hiện bao gồm một phương tiện chỉ định các tệp đầu vào là tệp UTF-8, độc lập với nội dung của chúng (nhận ra dấu lệnh byte là không đủ).</p>
<ul>
<li>Nếu một tệp đầu vào được xác định là tệp UTF-8, thì đó sẽ là chuỗi đơn vị mã UTF-8 được hình thành tốt và nó được giải mã để tạo ra một chuỗi các giá trị vô hướng Unicode. Một chuỗi của<a href="charset#Translation_character_set" title="cpp/language/charset">translation character set</a>Các phần tử sau đó được hình thành bằng cách ánh xạ từng giá trị vô hướng Unicode vào phần tử tập hợp ký tự dịch tương ứng. Trong trình tự kết quả, mỗi cặp ký tự trong chuỗi đầu vào bao gồm trả về vận chuyển (U+000D) theo sau là nguồn cấp dữ liệu dòng (U+000A), cũng như mỗi lần trả lại vận chuyển (U+000D) không ngay sau đó là nguồn cấp dữ liệu dòng (U+000a), được thay thế bằng một ký tự mới.</li>
<li>Đối với bất kỳ loại tệp đầu vào nào khác được hỗ trợ bởi việc triển khai, các ký tự được ánh xạ (theo cách xác định thực hiện) đến một chuỗi các phần tử tập hợp ký tự. Cụ thể, các chỉ số cuối dòng phụ thuộc OS được thay thế bằng các ký tự dòng mới.</li>
</ul> </td> <td><span class="t-mark-rev t-since-cxx23">(kể từ C ++ 23)</span></td>
</tr> </table> <h3 id="Phase_2">Giai đoạn 2</h3> <div class="t-li1">
<span class="t-li">1)</span> <span class="t-rev-inl t-since-cxx23"><span>Nếu ký tự dịch đầu tiên là dấu thứ tự byte (u+feff), nó sẽ bị xóa.</span><span><span class="t-mark-rev t-since-cxx23">(kể từ C ++ 23)</span></span></span>Bất cứ khi nào Backslash xuất hiện ở cuối dòng (ngay lập tức theo sau là<span class="t-rev-inl t-since-cxx23"><span>không hoặc nhiều ký tự khoảng trắng khác ngoài dòng mới, theo sau là</span><span><span class="t-mark-rev t-since-cxx23">(kể từ C ++ 23)</span></span></span>ký tự mới), các ký tự này bị xóa, kết hợp hai dòng nguồn vật lý thành một dòng nguồn logic. Đây là một hoạt động đơn; Một dòng kết thúc trong hai dấu gạch chéo ngược, sau đó là một dòng trống không kết hợp ba dòng thành một.</div> <div class="t-li1">
<span class="t-li">2)</span>Nếu một tệp nguồn không trống không kết thúc với ký tự dòng mới sau bước này (cho dù nó không có dòng mới ban đầu, hoặc nó kết thúc bằng một dòng mới ngay trước một dấu gạch chéo ngược), một ký tự mới kết thúc.</div> <h3 id="Phase_3">Giai đoạn 3</h3> <div class="t-li1">
<span class="t-li">1)</span>Tệp nguồn bị phân tách thành<a href="../comment" title="cpp/comment">comments</a>, trình tự các ký tự khoảng trắng (không gian, tab ngang, đường mới, tab dọc và cấp độ biểu mẫu) và<i>Mã thông báo tiền xử lý</i>, đó là như sau:</div> <div class="t-li2">
<span class="t-li">}</span>Tên tiêu đề như<code>&lt;iostream&gt;</code>hoặc<code>"myfile.h"</code>
</div> <table class="t-rev-begin"> <tr class="t-rev t-since-cxx20">
<td> <span class="t-li">{</span>Mã thông báo giữ chỗ được sản xuất bằng cách tiền xử lý<a href="modules" title="cpp/language/modules">import and module directives</a>biểu thị<code>import XXX;</code>Và<code>module XXX;</code>)</td> <td><span class="t-mark-rev t-since-cxx20">(phép chiếu danh tính).</span></td>
</tr> </table> <div class="t-li2">
<span class="t-li">}</span> <a href="identifiers" title="cpp/language/identifiers">identifiers</a>
</div> <div class="t-li2">
<span class="t-li">tải trong luồng B.</span>Số tiền xử lý</div> <div class="t-li2">
<span class="t-li">Không tham gia vào độ phân giải quá tải nếu biểu thức đó không được hình thành tốt.</span> <a href="character_literal" title="cpp/language/character literal">character literals</a><span class="t-rev-inl t-since-cxx11"><span>, bao gồm<a href="user_literal" title="cpp/language/user literal">user-defined</a>Nhân vật theo nghĩa đen</span><span><span class="t-mark-rev t-since-cxx11">(kể từ C ++ 11)</span></span></span>
</div> <div class="t-li2">
<span class="t-li">}</span> <a href="string_literal" title="cpp/language/string literal">string literals</a><span class="t-rev-inl t-since-cxx11"><span>, bao gồm<a href="user_literal" title="cpp/language/user literal">user-defined</a>chuỗi chữ</span><span><span class="t-mark-rev t-since-cxx11">(kể từ C ++ 11)</span></span></span>
</div> <div class="t-li2">
<span class="t-li">Sử dụng A :: F;</span>người vận hành và dấu chấm câu (bao gồm cả<a href="operator_alternative" title="cpp/language/operator alternative">alternative tokens</a>), chẳng hạn như<code>+</code>Thì<code>&lt;&lt;=</code>Thì<code>&lt;%</code>Thì<code>##</code>, hoặc<code>and</code>
</div> <div class="t-li2">
<span class="t-li"> </span>Các ký tự không phải là cá nhân không phù hợp với bất kỳ danh mục nào khác</div>Chương trình không được hình thành nếu nhân vật khớp với thể loại này là<ul>
<li>dấu nháy đơn (<code>'</code>, U+0027),</li>
<li>dấu ngoặc kép (<code>"</code>, U+0022), hoặc</li>
<li>một nhân vật không có trong<a href="charset" title="cpp/language/charset">basic character set</a>.</li>
</ul> <table class="t-rev-begin"> <tr class="t-rev t-since-cxx11">
<td> <span class="t-li">2)</span>Bất kỳ biến đổi nào được thực hiện trong<span class="t-rev-inl t-until-cxx23"><span>Giai đoạn 1 và</span><span><span class="t-mark-rev t-until-cxx23">(Cho đến C ++ 23)</span></span></span>Giai đoạn 2 giữa trích dẫn kép ban đầu và cuối cùng của bất kỳ<a href="string_literal" title="cpp/language/string literal">raw string literal</a>được hoàn nguyên.</td> <td><span class="t-mark-rev t-since-cxx11">(kể từ C ++ 11)</span></td>
</tr> </table> <div class="t-li1">
<span class="t-li">Mẫu &lt;class f, class tuple&gt;</span>Mỗi bình luận được thay thế bằng một ký tự không gian.</div> <p>Các dòng mới được giữ và nó không xác định liệu các chuỗi khoảng trắng không phải là mới có thể được thu gọn thành các ký tự không gian đơn hay không.</p>
<table class="t-rev-begin"> <tr class="t-rev t-since-cxx23">
<td> <p>Vì các ký tự từ tệp nguồn được tiêu thụ để tạo thành mã thông báo tiền xử lý tiếp theo (nghĩa là, không được tiêu thụ như một phần của nhận xét hoặc các dạng nào khác của khoảng trắng), tên ký tự phổ quát được công nhận và thay thế theo yếu tố được chỉ định của<a href="charset#Translation_character_set" title="cpp/language/charset">translation character set</a>, ngoại trừ khi khớp một chuỗi ký tự trong:</p>
<span class="t-li">}</span>Một<a href="character_literal" title="cpp/language/character literal">character literal</a>.<span class="t-spar">C-Char-Chuỗi</span>)<span class="t-li">{</span>Một<a href="string_literal" title="cpp/language/string literal">string literal</a>.<span class="t-spar">S-Char-Chuỗi</span>Và<span class="t-spar">R-Char-Chuỗi</span>), không bao gồm các phân định (<span class="t-spar">D-Char-Chuỗi</span>)<span class="t-li">}</span>Một<a href="../preprocessor/include" title="cpp/preprocessor/include">file name for inclusion</a>.<span class="t-spar">H-Char-Chuỗi</span>Và<span class="t-spar">Q-Char-Chuỗi</span>)</td> <td><span class="t-mark-rev t-since-cxx23">(kể từ C ++ 23)</span></td>
</tr> </table> <p>Nếu đầu vào đã được phân tích cú pháp vào các mã thông báo tiền xử lý lên đến một ký tự nhất định, thì mã thông báo tiền xử lý tiếp theo thường được thực hiện để là chuỗi các ký tự dài nhất có thể tạo thành mã thông báo tiền xử lý, ngay cả khi điều đó sẽ khiến phân tích tiếp theo không thành công. Điều này thường được gọi là<i>Munch tối đa</i>.</p>
<div class="cpp source-cpp"><pre data-language="cpp">int foo = 1;</pre></div> <p>int Bar = 0xe+foo;   // lỗi, số tiền xử lý không hợp lệ 0xe+foo</p>
<table class="t-rev-begin"> <tr class="t-rev t-since-cxx11">
<td> <ul><li>int Baz = 0xe + foo; // ĐƯỢC RỒI<a href="string_literal" title="cpp/language/string literal">raw string literal</a> </li></ul> <div class="cpp source-cpp"><pre data-language="cpp">int quux = thanh +++++ Baz; // Lỗi: Bar ++ +++Baz, không phải Bar +++++ Baz.</pre></div> <ul><li>Các ngoại lệ duy nhất cho quy tắc nhai tối đa là:<code>&lt;::</code>Nếu ký tự tiếp theo bắt đầu một chuỗi các ký tự có thể là tiền tố và trích dẫn kép ban đầu của một<code>:</code>constexpr outputit độc đáo_copy (đầu vào đầu tiên, đầu vào cuối cùng,<code>&gt;</code>    toán tử-= (const std :: chrono :: tháng &amp; dm) const noexcept;<code>&lt;</code>, Mã thông báo tiền xử lý tiếp theo sẽ là một chuỗi thô theo nghĩa đen. Theo nghĩa đen bao gồm chuỗi các ký tự ngắn nhất phù hợp với mẫu chuỗi thô.<a href="operator_alternative" title="cpp/language/operator alternative">alternative token</a> <code>&lt;:</code>).</li></ul> <div class="cpp source-cpp"><pre data-language="cpp">#Define R "X"</pre></div> </td> <td><span class="t-mark-rev t-since-cxx11">(kể từ C ++ 11)</span></td>
</tr> </table> <ul><li>const char* s = r "y"; // Chuỗi thô không hình thành theo nghĩa đen, không phải "x" "y"<a href="../preprocessor/include" title="cpp/preprocessor/include"><code> #include</code></a> <span class="t-rev-inl t-since-cxx20"><span>hoặc<a href="modules#Syntax" title="cpp/language/modules"><code>import</code></a></span><span><span class="t-mark-rev t-since-cxx20">(phép chiếu danh tính).</span></span></span>const char* s2 = r "(a)" "b)"; // một chuỗi thô theo nghĩa đen theo sau là một chuỗi bình thường theo nghĩa đen<span class="t-rev-inl t-since-cxx17"><span>hoặc trong a<a href="../preprocessor/include" title="cpp/preprocessor/include"><code>__has_include</code></a>  constexpr bool is_lteq (partial_ordering cmp) noexcept {return cmp &lt;= 0; }</span><span><span class="t-mark-rev t-since-cxx17">(C ++ 20)</span></span></span>.</li></ul> <div class="cpp source-cpp"><pre data-language="cpp">Nếu ba ký tự tiếp theo là</pre></div> <h3 id="Phase_4">Và nhân vật tiếp theo không phải là</h3> <div class="t-li1">
<span class="t-li">1)</span>Các<a href="../preprocessor" title="cpp/preprocessor">preprocessor</a>được thực hiện.</div> <div class="t-li1">
<span class="t-li">2)</span>được coi là một mã thông báo tiền xử lý của chính nó (và không phải là nhân vật đầu tiên của<a href="../preprocessor/include" title="cpp/preprocessor/include"><code> #include</code></a>struct foo {static const int v = 1; };</div> <div class="t-li1">
<span class="t-li">Mẫu &lt;class f, class tuple&gt;</span>std :: vector &lt;:: foo&gt; x; // ok, &lt;: không được lấy làm mã thông báo thay thế cho [</div> <h3 id="Phase_5">extern int y &lt;::&gt;;     // ok, giống như extern int y [].</h3> <table class="t-rev-begin"> <tr class="t-rev t-until-cxx23">
<td> <span class="t-li">1)</span>int z &lt;::: foo :: value:&gt;; // ok, int z [:: foo :: value];<a href="character_literal" title="cpp/language/character literal">character literals</a>Và<a href="string_literal" title="cpp/language/string literal">string literals</a>Tên tiêu đề Tiền xử lý các mã thông báo chỉ được hình thành trong một<a href="charset#Code_unit_and_literal" title="cpp/language/charset">encoding</a>chỉ thị<a href="charset#Basic_character_set" title="cpp/language/charset">basic character set</a>STD :: Vector &lt;Int&gt; x; // ok, &lt;int&gt; không phải là một tên tiêu đề<span class="t-li">2)</span> <a href="escape" title="cpp/language/escape">Escape sequences</a>Giai đoạn 4<p>Mỗi tệp được giới thiệu với<code>-finput-charset</code>Chỉ thị trải qua các giai đoạn 1 đến 4, đệ quy.<code>-fexec-charset</code>Và<code>-fwide-exec-charset</code>Vào cuối giai đoạn này, tất cả các chỉ thị tiền xử lý được xóa khỏi nguồn.<code>/source-charset</code>Và<code>/execution-charset</code>Giai đoạn 5</p>
</td> <td><span class="t-mark-rev t-until-cxx23">(Cho đến C ++ 23)</span></td>
</tr> <tr class="t-rev t-since-cxx23">
<td> <p>Tất cả các ký tự trong<a href="string_literal" title="cpp/language/string literal">string literal</a>được chuyển đổi từ ký tự nguồn được đặt thành<a href="string_literal#Concatenation" title="cpp/language/string literal">here</a>(có thể là một ký tự đa nhân mã hóa như UTF-8, miễn là 96 ký tự của</p>
</td> <td><span class="t-mark-rev t-since-cxx23">(kể từ C ++ 23)</span></td>
</tr> </table> <h3 id="Phase_6">có các biểu diễn byte đơn).</h3> <p>và tên ký tự phổ quát trong các chữ ký tự và chữ không raw được mở rộng và chuyển đổi thành mã hóa theo nghĩa đen. Nếu ký tự được chỉ định bởi một tên ký tự phổ quát không thể được mã hóa như một điểm mã duy nhất trong mã hóa theo nghĩa đen tương ứng, kết quả được xác định là thực hiện, nhưng được đảm bảo không phải là ký tự null (rộng).<a href="string_literal" title="cpp/language/string literal">string literals</a>Lưu ý: Việc chuyển đổi được thực hiện ở giai đoạn này có thể được kiểm soát bởi các tùy chọn dòng lệnh trong một số triển khai: sử dụng GCC và Clang</p>
<h3 id="Phase_7">Để chỉ định mã hóa của bộ ký tự nguồn,</h3> <p>Để chỉ định các mã hóa theo nghĩa đen thông thường và rộng tương ứng, trong khi Visual Studio 2015 cập nhật 2 và sau đó sử dụng</p>
<h3 id="Phase_8">Để chỉ định bộ ký tự nguồn và mã hóa theo nghĩa đen tương ứng.</h3> <p>Cho một chuỗi hai hoặc nhiều liền kề<a href="class_template" title="cpp/language/class template">explicit instantiations</a>mã thông báo, một tiền tố mã hóa phổ biến được xác định như mô tả<i>. Mỗi mã thông báo theo nghĩa đen như vậy sau đó được coi là có tiền tố mã hóa phổ biến đó. (Chuyển đổi ký tự được chuyển sang Giai đoạn 3)</i>.</p>
<h3 id="Phase_9">Giai đoạn 6</h3> <p>Liền kề</p>
<h3 id="Notes">Ghi chú</h3> <p>được nối.<a class="external text" href="https://docs.oracle.com/cd/E18659_01/html/821-1383/bkagr.html#scrolltoc" rel="nofollow">template repositories</a>hoặc<a class="external text" href="http://www-01.ibm.com/support/knowledgecenter/SSXVZZ_12.1.0/com.ibm.xlcpp121.linux.doc/compiler_ref/fcat_template.html?lang=en" rel="nofollow">template registries</a>Giai đoạn 7</p>
<h3 id="Defect_reports">Báo cáo khiếm khuyết</h3> <p>Các báo cáo khiếm khuyết thay đổi hành vi sau đây được áp dụng hồi tố cho các tiêu chuẩn C ++ được công bố trước đó.</p>
<table class="dsctable"> <tr> <th>Dr</th> <th>Áp dụng cho</th> <th>Hành vi như được công bố</th> <th>Hành vi chính xác</th>
</tr> <tr> <td>
<a class="external text" href="https://cplusplus.github.io/CWG/issues/787.html" rel="nofollow">CWG 787</a> </td> <td>C ++ 98</td> <td>Việc biên dịch diễn ra: Mỗi mã thông báo tiền xử lý được chuyển đổi thành mã thông báo. Các mã thông báo được phân tích về mặt cú pháp và ngữ nghĩa và dịch như một đơn vị dịch thuật.<br/>Giai đoạn 8</td> <td>Mỗi đơn vị dịch được kiểm tra để tạo ra một danh sách các bản khởi tạo mẫu cần thiết, bao gồm cả các đơn vị được yêu cầu bởi<br/>. Các định nghĩa của các mẫu được định vị và các khởi tạo cần thiết được thực hiện để sản xuất</td>
</tr> <tr> <td>
<a class="external text" href="https://cplusplus.github.io/CWG/issues/1775.html" rel="nofollow">CWG 1775</a> </td> <td>C ++ 11</td> <td>đơn vị khởi tạo<br/>Giai đoạn 9</td> <td>    T2 () {} // "mem" không có trong danh sách khởi tạo</td>
</tr> <tr> <td>
<a class="external text" href="https://wg21.link/P2621R2" rel="nofollow">P2621R2</a> </td> <td>C ++ 98</td> <td>Các đơn vị dịch thuật, đơn vị khởi tạo và các thành phần thư viện cần thiết để đáp ứng các tài liệu tham khảo bên ngoài được thu thập vào hình ảnh chương trình có chứa thông tin cần thiết để thực hiện trong môi trường thực hiện của nó.<br/>Một số trình biên dịch không thực hiện các đơn vị khởi tạo (còn được gọi là</td> <td>cho phép</td>
</tr>
</table> <h3 id="References">Tài liệu tham khảo</h3> <ul>
<li>C ++ 23 Tiêu chuẩn (ISO/IEC 14882: 2023):</li>
<ul><li>không kết thúc với một nhân vật mới ở cuối giai đoạn 2</li></ul>
<li>Tiêu chuẩn C ++ 20 (ISO/IEC 14882: 2020):</li>
<ul><li>không kết thúc với một nhân vật mới ở cuối giai đoạn 2</li></ul>
<li>Tiêu chuẩn C ++ 17 (ISO/IEC 14882: 2017):</li>
<ul><li>không kết thúc với một nhân vật mới ở cuối giai đoạn 2</li></ul>
<li>Tiêu chuẩn C ++ 14 (ISO/IEC 14882: 2014):</li>
<ul><li>nhân vật trong trường hợp này</li></ul>
<li>Tiêu chuẩn C ++ 11 (ISO/IEC 14882: 2011):</li>
<ul><li>nhân vật trong trường hợp này</li></ul>
<li>Tiêu chuẩn C ++ 03 (ISO/IEC 14882: 2003):</li>
<ul><li>Chuỗi theo nghĩa đen trong Giai đoạn 2 dẫn đến hành vi không xác định</li></ul>
<li>    S.B3 = 0B11;</li>
<ul><li>Chuỗi theo nghĩa đen trong Giai đoạn 2 dẫn đến hành vi không xác định</li></ul>
</ul> <h3 id="See_also">(chức năng)</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td colspan="2"> <span><a href="https://en.cppreference.com/w/c/language/translation_phases" title="c/language/translation phases">C documentation</a></span>vì<span class=""><span>Tên nhân vật phổ quát không được phép</span></span> </td>
</tr> </table> <div class="_attribution">
<p class="_attribution-p">© CPPReference.com<br/>Được cấp phép theo giấy phép Creative Commons Attribution-Sharealike không được chứng minh v3.0.<br/>
<a class="_attribution-link" href="https://en.cppreference.com/w/cpp/language/translation_phases">https://en.cppreference.com/w/cpp/language/translation_phases</a>
</p>
</div>
