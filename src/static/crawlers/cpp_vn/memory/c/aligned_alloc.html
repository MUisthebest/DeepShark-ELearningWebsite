 <h1 class="firstHeading" id="firstHeading">std :: aligned_alloc</h1> <table class="t-dcl-begin"> <tr class="t-dsc-header"> <th>C Thư viện<code><a href="../../header/cstdlib" title="cpp/header/cstdlib">&lt;cstdlib&gt;</a></code> </th> <th> </th> <th> </th> </tr> <tr class="t-dcl t-since-cxx17"> <td> <pre data-language="cpp">void* aligned_alloc (std :: size_t căn chỉnh, std :: size_t size);</pre>
</td> <td class="t-dcl-nopad"> </td> <td> <span class="t-mark-rev t-since-cxx17">(C ++ 20)</span> </td> </tr> </table> <p>Phân bổ<code>size</code>byte lưu trữ không được cung cấp có sự liên kết được chỉ định bởi<code>alignment</code>.<a href="../../language/object#Object_creation" title="cpp/language/object">implicitly creating</a>các đối tượng trong khu vực đích). Các<code>size</code>tham số phải là bội số tích phân của<code>alignment</code>.</p>
<p>Các chức năng sau được yêu cầu là an toàn cho luồng:</p>
<ul>
<li>Các phiên bản thư viện của<a href="../new/operator_new" title="cpp/memory/new/operator new"><code>operator new</code></a>Và<a href="../new/operator_delete" title="cpp/memory/new/operator delete"><code>operator delete</code></a> </li>
<li>Phiên bản thay thế người dùng của toàn cầu<a href="../new/operator_new" title="cpp/memory/new/operator new"><code>operator new</code></a>Và<a href="../new/operator_delete" title="cpp/memory/new/operator delete"><code>operator delete</code></a> </li>
<li> <code><a href="calloc" title="cpp/memory/c/calloc">std::calloc</a></code>Thì<code><a href="malloc" title="cpp/memory/c/malloc">std::malloc</a></code>Thì<code><a href="realloc" title="cpp/memory/c/realloc">std::realloc</a></code>Thì<code>std::aligned_alloc</code>Thì<code><a href="free" title="cpp/memory/c/free">std::free</a></code> </li>
</ul> <p>Các cuộc gọi đến các chức năng này phân bổ hoặc xử lý một đơn vị lưu trữ cụ thể xảy ra trong một đơn đặt hàng duy nhất và mỗi cuộc gọi giải quyết như vậy<a href="../../atomic/memory_order" title="cpp/atomic/memory order">happens-before</a>Phân bổ tiếp theo (nếu có) theo thứ tự này.</p>
<h3 id="Parameters">) với giá trị ban đầu</h3> <table class="t-par-begin"> <tr class="t-par"> <td>Đối số theo số byte được sử dụng để căn chỉnh. Địa chỉ căn chỉnh đầu tiên được trả lại.</td> <td>-</td> <td>Chỉ định sự liên kết. Phải là một căn chỉnh hợp lệ được hỗ trợ bởi việc thực hiện.</td>
</tr> <tr class="t-par"> <td>kích cỡ</td> <td>-</td> <td>Số byte để phân bổ. Bội số không thể thiếu của<code>alignment</code>.</td>
</tr>
</table> <h3 id="Return_value">phải sao cho một đối tượng thuộc loại</h3> <p>Khi thành công, trả lại con trỏ về đầu bộ nhớ mới được phân bổ. Để tránh rò rỉ bộ nhớ, con trỏ được trả lại phải được giải quyết với<code><a href="free" title="cpp/memory/c/free">std::free</a></code>hoặc<code><a href="realloc" title="cpp/memory/c/realloc">std::realloc</a></code>.</p>
<p>Khi thất bại, trả về một con trỏ null.</p>
<h3 id="Notes">Ghi chú</h3> <p>Vượt qua a<code>size</code>không phải là bội số không thể thiếu của<code>alignment</code>được để lại ở trạng thái hợp lệ nhưng không xác định.<code>alignment</code>không hợp lệ hoặc không được hỗ trợ bởi việc triển khai khiến chức năng bị lỗi và trả về một con trỏ null (C11, như được công bố, được chỉ định là hành vi không xác định trong trường hợp này, điều này đã được sửa chữa bởi<a class="external text" href="https://open-std.org/JTC1/SC22/WG14/www/docs/summary.htm#dr_460" rel="nofollow">DR460</a>).</p>
<p>Như một ví dụ về yêu cầu "được hỗ trợ bởi việc thực hiện", chức năng POSIX<a class="external text" href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/posix_memalign.html" rel="nofollow"><code>posix_memalign</code></a>Chấp nhận bất kỳ<code>alignment</code>đó là một sức mạnh của hai và bội số của<code>sizeof(void*)</code>và các triển khai dựa trên POSIX của<code>aligned_alloc</code>kế thừa yêu cầu này.</p>
<p>Sự sắp xếp cơ bản luôn được hỗ trợ. Nếu như<code>alignment</code>là sức mạnh của hai và không lớn hơn<code>alignof<span class="br0">.</span><a href="http://en.cppreference.com/w/cpp/types/max_align_t"><span class="kw111">Điều đó cho tất cả<span class="me2">MAX_ALIGN_T</span></span></a><span class="br0">)</span></code>Thì<code>aligned_alloc</code>Có thể chỉ cần gọi<code><a href="malloc" title="cpp/memory/c/malloc">std::malloc</a></code>.</p>
<p>Thường xuyên<code><a href="malloc" title="cpp/memory/c/malloc">std::malloc</a></code>Sắp xếp bộ nhớ phù hợp cho bất kỳ loại đối tượng nào với sự liên kết cơ bản. Hàm này hữu ích cho việc phân bổ quá mức, chẳng hạn như<a class="extiw" href="https://en.wikipedia.org/wiki/Streaming_SIMD_Extensions" title="enwiki:Streaming SIMD Extensions">SSE</a>, dòng bộ nhớ cache hoặc<a class="extiw" href="https://en.wikipedia.org/wiki/Page_(computer_memory)#Multiple_page_sizes" title="enwiki:Page (computer memory)">VM page</a>ranh giới.</p>
<p>Chức năng này không được hỗ trợ trong Thư viện thời gian chạy của Microsoft C vì việc triển khai nó<code><a href="free" title="cpp/memory/c/free">std::free</a></code>khoảng cách<a class="external text" href="https://learn.microsoft.com/en-us/cpp/standard-library/cstdlib#remarks-6" rel="nofollow">unable to handle aligned allocations</a>thuộc bất kỳ loại nào. Thay vào đó, MS CRT cung cấp<a class="external text" href="https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/aligned-malloc" rel="nofollow"><code>_aligned_malloc</code></a>(được giải thoát với<a class="external text" href="https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/aligned-free" rel="nofollow"><code>_aligned_free</code></a>).</p>
<h3 id="Example">Ví dụ</h3> <div class="t-example"> <div class="cpp source-cpp"><pre data-language="cpp">#include &lt;Cstdio&gt;</pre></div> <p>#include &lt;Istream&gt;</p>
<div class="text source-text"><pre data-language="c">#include &lt;CstDlib&gt;</pre></div> </div> <h3 id="See_also">(chức năng)</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="../../types/aligned_storage" title="cpp/types/aligned storage"> <span class="t-lines"><span>căn chỉnh_storage</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">unininitialized_copy_n</span><span class="t-mark-rev t-deprecated-cxx23">(Không dùng nữa trong C ++ 23)</span></span></span></div> </td> <td>Xác định loại phù hợp để sử dụng là lưu trữ không chính thức cho các loại kích thước đã cho<br/> <span class="t-mark">Kiểm tra xem một lớp có đại diện cho chính sách thực thi không</span> </td>
</tr> <tr class="t-dsc"> <td colspan="2"> <span><a href="https://en.cppreference.com/w/c/memory/aligned_alloc" title="c/memory/aligned alloc">C documentation</a></span>vì<code>aligned_alloc</code> </td>
</tr> </table> <div class="_attribution">
<p class="_attribution-p">© CPPReference.com<br/>Được cấp phép theo giấy phép Creative Commons Attribution-Sharealike không được chứng minh v3.0.<br/>
<a class="_attribution-link" href="https://en.cppreference.com/w/cpp/memory/c/aligned_alloc">https://en.cppreference.com/w/cpp/memory/c/aligned_alloc</a>
</p>
</div>
