 <h1 class="firstHeading" id="firstHeading">std :: malloc</h1> <table class="t-dcl-begin"> <tr class="t-dsc-header"> <th>C Thư viện<code><a href="../../header/cstdlib" title="cpp/header/cstdlib">&lt;cstdlib&gt;</a></code> </th> <th> </th> <th> </th> </tr> <tr class="t-dcl"> <td class="t-dcl-nopad"> <pre data-language="cpp">void* malloc (std :: size_t size);</pre>
</td> <td class="t-dcl-nopad"> </td> <td class="t-dcl-nopad"> </td> </tr> </table> <p>Phân bổ<code>size</code>Byte của lưu trữ không chính thức.</p>
<p>Nếu phân bổ thành công, hãy trả một con trỏ xuống mức thấp nhất (đầu tiên) trong khối bộ nhớ được phân bổ được sắp xếp phù hợp cho bất kỳ loại vô hướng nào (ít nhất là nghiêm ngặt như<code><a href="../../types/max_align_t" title="cpp/types/max align t">std::max_align_t</a></code>) (<a href="../../language/object#Object_creation" title="cpp/language/object">implicitly creating</a>các đối tượng trong khu vực đích).</p>
<p>Nếu như<code>size</code>bằng không, hành vi được thực hiện được xác định (có thể trả về con trỏ null hoặc một số con trỏ không null có thể được trả về có thể không được sử dụng để truy cập lưu trữ, nhưng phải được chuyển sang<code><a href="free" title="cpp/memory/c/free">std::free</a></code>).</p>
<table class="t-rev-begin"> <tr class="t-rev t-since-cxx11">
<td> <p>Các chức năng sau được yêu cầu là an toàn cho luồng:</p>
<ul>
<li>Các phiên bản thư viện của<a href="../new/operator_new" title="cpp/memory/new/operator new"><code>operator new</code></a>Và<a href="../new/operator_delete" title="cpp/memory/new/operator delete"><code>operator delete</code></a> </li>
<li>Phiên bản thay thế người dùng của toàn cầu<a href="../new/operator_new" title="cpp/memory/new/operator new"><code>operator new</code></a>Và<a href="../new/operator_delete" title="cpp/memory/new/operator delete"><code>operator delete</code></a> </li>
<li> <code><a href="calloc" title="cpp/memory/c/calloc">std::calloc</a></code>Thì<code>std::malloc</code>Thì<code><a href="realloc" title="cpp/memory/c/realloc">std::realloc</a></code><span class="t-rev-inl t-since-cxx17"><span>Thì<code><a href="aligned_alloc" title="cpp/memory/c/aligned alloc">std::aligned_alloc</a></code></span><span><span class="t-mark-rev t-since-cxx17">(C ++ 20)</span></span></span>Thì<code><a href="free" title="cpp/memory/c/free">std::free</a></code> </li>
</ul> <p>Các cuộc gọi đến các chức năng này phân bổ hoặc xử lý một đơn vị lưu trữ cụ thể xảy ra trong một đơn đặt hàng duy nhất và mỗi cuộc gọi giải quyết như vậy<a href="../../atomic/memory_order" title="cpp/atomic/memory order">happens-before</a>Phân bổ tiếp theo (nếu có) theo thứ tự này.</p>
</td> <td><span class="t-mark-rev t-since-cxx11">(kể từ C ++ 11)</span></td>
</tr> </table> <h3 id="Parameters">) với giá trị ban đầu</h3> <table class="t-par-begin"> <tr class="t-par"> <td>kích cỡ</td> <td>-</td> <td>số byte để phân bổ</td>
</tr>
</table> <h3 id="Return_value">phải sao cho một đối tượng thuộc loại</h3> <p>Khi thành công, trả lại con trỏ về đầu bộ nhớ mới được phân bổ. Để tránh rò rỉ bộ nhớ, con trỏ được trả lại phải được giải quyết với<code><a href="free" title="cpp/memory/c/free">std::free()</a></code>hoặc<code><a href="realloc" title="cpp/memory/c/realloc">std::realloc()</a></code>.</p>
<p>Khi thất bại, trả về một con trỏ null.</p>
<h3 id="Notes">Ghi chú</h3> <p>Hàm này không gọi các hàm tạo hoặc khởi tạo bộ nhớ theo bất kỳ cách nào. Không có con trỏ thông minh sẵn sàng sử dụng nào có thể đảm bảo rằng chức năng giao dịch phù hợp được gọi. Phương pháp phân bổ bộ nhớ ưa thích trong C ++ là sử dụng các hàm sẵn sàng<code><a href="../unique_ptr/make_unique" title="cpp/memory/unique ptr/make unique">std::make_unique</a></code>Thì<code><a href="../shared_ptr/make_shared" title="cpp/memory/shared ptr/make shared">std::make_shared</a></code>, các hàm tạo container, v.v., và, trong mã thư viện cấp thấp,<a href="../../language/new" title="cpp/language/new">new-expression</a>.</p>
<p>Để tải một tệp lớn, ánh xạ tệp qua các chức năng dành riêng cho hệ điều hành, ví dụ:<a class="external text" href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/mmap.html" rel="nofollow"><code>mmap</code></a>trên posix hoặc<code>CreateFileMapping</code>.<a class="external text" href="https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-createfilemappinga" rel="nofollow"><code>A</code></a>/<a class="external text" href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-createfilemappingw" rel="nofollow"><code>W</code></a>) cùng với<a class="external text" href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile" rel="nofollow"><code>MapViewOfFile</code></a>Trên Windows, tốt hơn là phân bổ bộ đệm để đọc tệp.</p>
<h3 id="Example">Ví dụ</h3> <div class="t-example"> <div class="cpp source-cpp"><pre data-language="cpp">#include &lt;CstDlib&gt; </pre></div> <p>Nếu (sai)</p>
<div class="text source-text"><pre data-language="c">#include &lt;Istream&gt;   </pre></div> </div> <h3 id="See_also">(chức năng)</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="../new/operator_new" title="cpp/memory/new/operator new"> <span class="t-lines"><span>nhà điều hành mới</span><span>nhà điều hành mới []</span></span></a></div> </td> <td>chức năng phân bổ<br/> <span class="t-mark">Tìm kiếm một mảng cho một yếu tố thuộc loại không xác định</span> </td>
</tr> <tr class="t-dsc"> <td> <div><a href="../get_temporary_buffer" title="cpp/memory/get temporary buffer"> <span class="t-lines"><span>get_temden_buffer</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark">(không được dùng trong C ++ 17)</span></span><span><span class="t-mark-rev t-until-cxx20">(Đã xóa trong C ++ 20)</span></span></span></div> </td> <td>Có được lưu trữ không chính thức<br/> <span class="t-mark">tạo một đối tượng tại một địa chỉ nhất định</span> </td>
</tr> <tr class="t-dsc"> <td colspan="2"> <span><a href="https://en.cppreference.com/w/c/memory/malloc" title="c/memory/malloc">C documentation</a></span>vì<code>malloc</code> </td>
</tr> </table> <div class="_attribution">
<p class="_attribution-p">© CPPReference.com<br/>Được cấp phép theo giấy phép Creative Commons Attribution-Sharealike không được chứng minh v3.0.<br/>
<a class="_attribution-link" href="https://en.cppreference.com/w/cpp/memory/c/malloc">https://en.cppreference.com/w/cpp/memory/c/malloc</a>
</p>
</div>
